<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>PFANT: Coding style</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo0.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">PFANT
   &#160;<span id="projectnumber">version 15.08.27a</span>
   </div>
   <div id="projectbrief">Spectral synthesis software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('coding_style.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Coding style </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Sketch of a coding style manual</p>
<h1>Format </h1>
<p>Now using the "modern" .f90-.f95 file format (instead of .f "punchcard").</p>
<h2>Indentation </h2>
<ul>
<li>2-space indentation for all IF, DO, SUBROUTINE etc. structures.</li>
</ul>
<ul>
<li>Continuation lines: suggestion: continue with a 1-space indentation from the beginning line, i.e.:</li>
</ul>
<div class="fragment"><div class="line">... WRITE (*,*) <span class="stringliteral">&#39;A equals &#39;</span>, A, <span class="stringliteral">&#39;; B equals &#39;</span>, B, <span class="stringliteral">&#39;; C equals &#39;</span>, &amp;</div>
<div class="line">...  C, <span class="stringliteral">&#39;D equals &#39;</span>, D</div>
<div class="line">     |</div>
<div class="line">     1-space indentation after beginning line</div>
</div><!-- fragment --><h2>Number of columns </h2>
<p>Rule for all <code></code>.f, <code></code>.f90, and <code></code>.txt files: <em>90-column maximum</em>. This is probably a good a compromise between predominant sense (which is 80-column, arguing about readability and ergonomics), accessibility (code being read by different people on different system setups) and horizontal space (not having to wrap formulas and long lines of code too often). <a class="el" href="references.html#Cesm0">Cesm0</a> <a class="el" href="references.html#StackEx0">StackEx0</a> <a class="el" href="references.html#JavaGuide">JavaGuide</a></p>
<h1>COMMON blocks </h1>
<p>Do <em>not</em> use COMMON blocks (use Fortran module instead)!</p>
<h1>Data types </h1>
<p>real*8 is used throughout, except for reading the binary .mod files.</p>
<p>"If you must use floating point, use double precision unless you have reason to be concerned about memory use (your program uses large arrays) and you do not need much precision. Modern computers do not take significantly longer to process double precision values than they do to process reals." <a class="el" href="references.html#Uwm0">Uwm0</a></p>
<h1>Programming </h1>
<h2>Always IMPLICIT NONE </h2>
<p>Add the IMPLICIT NONE statement at the beginning of each MODULE or PROGRAM. Advantages: </p><ul>
<li>type of variables becomes clear (not all code readers will know about Fortran i-n convention; </li>
<li>we are forced to declare real variables as real*8.</li>
</ul>
<h2>Case convention </h2>
<p>All symbol (variable, function, subroutine, module) names are now declared in <em>lowercase</em>, except for <em>constants</em> which are all <em>UPPERCASE</em>.</p>
<dl class="section note"><dt>Note</dt><dd>The main reasons for this was a limitation in Doxygen, which converts all symbols to lowercase in the HTMLs anyway (fix has been asked for but no action yet <a href="http://doxygen.10944.n7.nabble.com/The-lowercase-problem-when-using-the-Doxygen-with-Fortran-td1243.html">http://doxygen.10944.n7.nabble.com/The-lowercase-problem-when-using-the-Doxygen-with-Fortran-td1243.html</a>). It sucks to have to change your code conventions because of the documentation tool, but considering all you get from Doxygen, it seemed to be a good trade-off. The symbols could have been left in uppercase in the source code and would appear in lowercase in the HTML, but this would be kind of confusing.</dd></dl>
<h2>Name conventions </h2>
<ul>
<li>Routines <a class="el" href="namespacesynthesis.html#af6dfd3c2d7d2be83e4bcc7e2472840c5">synthesis::synthesis_</a> and <a class="el" href="namespaceabsoru.html#a2d60649af39c2775d4002eb8fda0a91b" title="Calculates the &quot;continuum absorption&quot;. ">absoru::absoru_</a> names have a trailing underscore in order to differentiate from their respective module names;</li>
</ul>
<ul>
<li>Prefixes are now used extensively throughout the code to group variables according to some meaning, for example: <div class="fragment"><div class="line"><a class="code" href="namespacereader__main.html#ad68146ac61901a73339b442200e5222f">main_ptdisk</a>     ! variable comes from file main.dat</div>
<div class="line"><a class="code" href="namespacesynthesis.html#a58951f64bdf3b80a6e2932e82f2f0a3b">selekfh_fl</a>      ! variable is calculated by subroutine <a class="code" href="pfant_8f90.html#ac8f00ffce7216c0a8b834684e1b094c7">synthesis::selekfh</a>()</div>
<div class="line">MAX_PARTIT_NPAR ! constant having <a class="code" href="namespacedimensions.html#a9c3718f2b254c9e2f7b41f9975f4f274">maximum</a> allowed <a class="code" href="namespacedimensions.html#a364432bc2cd4a68d54fea6a7ed867f3c">value</a> <a class="code" href="namespacedimensions.html#ad3dff1b084c6b6cb0426e2253a2a95dd">of</a> variable <a class="code" href="namespacereader__partit.html#a2f2e81d9bce1b250bb592d220868f09b">partit_npar</a></div>
<div class="line">...</div>
</div><!-- fragment --></li>
</ul>
<p>Every module should explain the meaning of its own prefixes.</p>
<h2>Variable declarations </h2>
<ul>
<li>Always use intent(in/out) for subroutine/function arguments. This will allow the reader to know which arguments are inputs and which arguments are outputs for the subroutine. </li>
<li><b>Module globals and subroutine/function arguments</b>: declare <em>only one</em> variable per code line, and document the variable. </li>
<li><b>Any variable</b>: document the variable if its use/purpose is not obviuos.</li>
</ul>
<h2>Function/subroutines </h2>
<p>Write documentation explaining what the function/subroutine does and whenever possible, why it was created.</p>
<h2>Logging (i.e., printing things on the screen) </h2>
<p>For outputting messages on the screen, use the routines in the LOGGING module (not just WRITE or PRINT). This may give a bit more work (may require one extra line of code if the string is formatted), but there are good reasons for that. There are different routines to be used, such as <a class="el" href="namespacelogging.html#a6f4a56f63163c7cd4803dedca0bbe792" title="Logs message as CRITICAL. ">log_critical()</a>, <a class="el" href="namespacelogging.html#a9cc50687094614948dc73de63bf7a0fd" title="Logs message as ERROR. ">log_error()</a>, <a class="el" href="namespacelogging.html#a145c6bf29be38b84aff4f4b72bbd60b5" title="Logs message as WARNING. ">log_warning()</a>, <a class="el" href="namespacelogging.html#a6318ac0003d973079d7b4ffd04751a7b" title="Logs message as INFO. ">log_info()</a>, <a class="el" href="namespacelogging.html#a955fa2a6e2d2136983ce8b177a294f73" title="Logs message as DEBUG. ">log_debug()</a>.</p>
<p>Logging can be silenced and/or sent to specific logging file using command-line config options.</p>
<p>For assertions, call log_halt("message", is_assertion=.true.).</p>
<dl class="section note"><dt>Note</dt><dd>Assertions are checks against coding errors. Assertions serve both as documentation and error protection.</dd></dl>
<h2>How to document the code </h2>
<p>Note that </p><div class="fragment"><div class="line">!&gt; </div>
</div><!-- fragment --><p> refers to what comes after, and </p><div class="fragment"><div class="line">!&lt;</div>
</div><!-- fragment --><p> refers to what comes before.</p>
<h2>Tags </h2>
<p>Some tags used in comments throughout the source code:</p>
<dl class="section note"><dt>Note</dt><dd>All tags, except "@todo" are case-insensitive.</dd></dl>
<pre class="fragment">@todo                  Doxygen's todo tag. Note that not all "todos" are marked in this
                       way

issue                  Something that needs to be solved in the code. Similar to @todo
                       (this tag was being used before Doxygen was adopted)

?doc?                  Item (variable/subroutine etc) lacks proper documentation

?what?                 More serious version of ?doc?: crucial item (variable/subroutine etc)
                       is undocumented. This is reserved undocumented items that seem
                       important

ask BLB
ask PC
ask MT                 Suggests the person who probably knows to solve the issue</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="coding_guide.html">Coding guide</a></li>
    <li class="footer">Generated on Thu Aug 27 2015 10:43:15 for PFANT by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
