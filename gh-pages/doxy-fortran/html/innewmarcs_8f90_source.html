<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>PFANT: src/innewmarcs.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo0.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">PFANT
   &#160;<span id="projectnumber">version 15.07.17a</span>
   </div>
   <div id="projectbrief">Spectral synthesis software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('innewmarcs_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">innewmarcs.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="innewmarcs_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!||| MODULE ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__x.html">    8</a></span>&#160;<span class="keyword">module</span> <a class="code" href="namespaceinnewmarcs__x.html">innewmarcs_x</a></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacelogging.html">logging</a></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacereader__main.html">reader_main</a></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespaceconfig.html">config</a></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="comment">! x_* values may come either from command line or dfile:main</span></div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__x.html#a398298b0edbd739992bdd19c63d3ca7c">   15</a></span>&#160;  <span class="keywordtype">real*4</span> :: <a class="code" href="namespaceinnewmarcs__x.html#a398298b0edbd739992bdd19c63d3ca7c">x_teff</a>, <a class="code" href="namespaceinnewmarcs__x.html#a3a715cba698db477f3106b89369278e5">x_glog</a>, <a class="code" href="namespaceinnewmarcs__x.html#a6b99e08d1f950896d0942333e7edc066">x_asalog</a></div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__x.html#acfb0dabe633715425c3d7b11ae96faa2">   16</a></span>&#160;  <span class="keywordtype">character(LEN_TIRB)</span> :: <a class="code" href="namespaceinnewmarcs__x.html#acfb0dabe633715425c3d7b11ae96faa2">x_tirb</a></div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__x.html#a1a96ef8a82941f6ae8f54e134b06879f">   17</a></span>&#160;  <span class="keywordtype">integer</span> :: <a class="code" href="namespaceinnewmarcs__x.html#a1a96ef8a82941f6ae8f54e134b06879f">x_inum</a></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">contains</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">  subroutine </span><a class="code" href="namespaceinnewmarcs__x.html#a3f35348d405aa967eb1a95335a4b4d28">innewmarcs_init_x</a>()</div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__x.html#a3f35348d405aa967eb1a95335a4b4d28">   24</a></span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">! values in config_* variables have preference, but if they are uninitialized, will</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">! pick values from dfile:main</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;     <a class="code" href="namespaceinnewmarcs__x.html#a398298b0edbd739992bdd19c63d3ca7c">x_teff</a> = <span class="keywordtype">real</span>(<a class="code" href="namespaceconfig.html#affc9a22fb2947d54c06100575bba55fb">config_teff</a>)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;     <a class="code" href="namespaceinnewmarcs__x.html#a3a715cba698db477f3106b89369278e5">x_glog</a> = <span class="keywordtype">real</span>(<a class="code" href="namespaceconfig.html#a858736a1e48025c7a5f70103abc8bdcf">config_glog</a>)</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;     <a class="code" href="namespaceinnewmarcs__x.html#a6b99e08d1f950896d0942333e7edc066">x_asalog</a> = <span class="keywordtype">real</span>(<a class="code" href="namespaceconfig.html#a807f33f9ef82010f14c655e653f0865c">config_asalog</a>)</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;     <a class="code" href="namespaceinnewmarcs__x.html#a1a96ef8a82941f6ae8f54e134b06879f">x_inum</a>   = <a class="code" href="namespaceconfig.html#ad0b23351067d0e18d2f215b8e6d87eb7">config_inum</a></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;     <a class="code" href="namespaceinnewmarcs__x.html#acfb0dabe633715425c3d7b11ae96faa2">x_tirb</a> = <a class="code" href="namespaceconfig.html#a4758985ac722154dea63f96f73b84657">config_tirb</a></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceconfig.html#ad0b23351067d0e18d2f215b8e6d87eb7">config_inum</a> .lt. 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereader__main.html#ab0340083926cd8b86e6a42dd62c7ee6b">assure_read_main</a>()</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keywordflow">if</span> (main_inum .lt. 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="comment">! note: here this consistency check is considered an assertion, because it should</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="comment">! be validated upon file reading.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacelogging.html#a4fc75cb7a1e0429e297ce0160f8e2364">pfant_halt</a>(<span class="stringliteral">&#39;Invalid value for main_inum: &#39;</span>//int2str(main_inum), is_assertion=.true.)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <a class="code" href="namespaceinnewmarcs__x.html#a1a96ef8a82941f6ae8f54e134b06879f">x_inum</a> = main_inum</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceconfig.html#a769185a6790e659a782cb1a5ae1c5f34">parse_aux_log_assignment</a>(<span class="stringliteral">&#39;x_inum&#39;</span>, int2str(<a class="code" href="namespaceinnewmarcs__x.html#a1a96ef8a82941f6ae8f54e134b06879f">x_inum</a>))</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceconfig.html#a4758985ac722154dea63f96f73b84657">config_tirb</a> .eq. <span class="stringliteral">&#39;?&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereader__main.html#ab0340083926cd8b86e6a42dd62c7ee6b">assure_read_main</a>()</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <a class="code" href="namespaceinnewmarcs__x.html#acfb0dabe633715425c3d7b11ae96faa2">x_tirb</a> = <a class="code" href="namespacereader__main.html#a486ec8f0965940c32c610faed704a592">main_titrav</a></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceconfig.html#a769185a6790e659a782cb1a5ae1c5f34">parse_aux_log_assignment</a>(<span class="stringliteral">&#39;x_tirb&#39;</span>, trim(<a class="code" href="namespaceinnewmarcs__x.html#acfb0dabe633715425c3d7b11ae96faa2">x_tirb</a>))</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceconfig.html#affc9a22fb2947d54c06100575bba55fb">config_teff</a> .eq. -1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereader__main.html#ab0340083926cd8b86e6a42dd62c7ee6b">assure_read_main</a>()</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <a class="code" href="namespaceinnewmarcs__x.html#a398298b0edbd739992bdd19c63d3ca7c">x_teff</a> = <span class="keywordtype">real(main_teff)</span>  <span class="comment">! explicit real(8)-to-real(4) conversion to shut up warning</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceconfig.html#a769185a6790e659a782cb1a5ae1c5f34">parse_aux_log_assignment</a>(<span class="stringliteral">&#39;x_teff&#39;</span>, real42str(<a class="code" href="namespaceinnewmarcs__x.html#a398298b0edbd739992bdd19c63d3ca7c">x_teff</a>, 1))</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceconfig.html#a858736a1e48025c7a5f70103abc8bdcf">config_glog</a> .eq. -1)  <span class="keywordflow">then</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereader__main.html#ab0340083926cd8b86e6a42dd62c7ee6b">assure_read_main</a>()</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <a class="code" href="namespaceinnewmarcs__x.html#a3a715cba698db477f3106b89369278e5">x_glog</a> = <span class="keywordtype">real</span>(<a class="code" href="namespacereader__main.html#ab83921c26c1f1b4f3d12b8ff7c7158eb">main_glog</a>)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceconfig.html#a769185a6790e659a782cb1a5ae1c5f34">parse_aux_log_assignment</a>(<span class="stringliteral">&#39;x_glog&#39;</span>, real42str(<a class="code" href="namespaceinnewmarcs__x.html#a3a715cba698db477f3106b89369278e5">x_glog</a>, 3))</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceconfig.html#a807f33f9ef82010f14c655e653f0865c">config_asalog</a> .eq. -1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereader__main.html#ab0340083926cd8b86e6a42dd62c7ee6b">assure_read_main</a>()</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <a class="code" href="namespaceinnewmarcs__x.html#a6b99e08d1f950896d0942333e7edc066">x_asalog</a> = <span class="keywordtype">real</span>(<a class="code" href="namespacereader__main.html#a743c64b380aba20c8d36ba00b608e68e">main_asalog</a>)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceconfig.html#a769185a6790e659a782cb1a5ae1c5f34">parse_aux_log_assignment</a>(<span class="stringliteral">&#39;x_asalog&#39;</span>, real42str(<a class="code" href="namespaceinnewmarcs__x.html#a6b99e08d1f950896d0942333e7edc066">x_asalog</a>, 3))</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keyword">  end</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">end</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">!|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">!||| MODULE ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">!|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__calc.html">   71</a></span>&#160;<span class="keyword">module</span> <a class="code" href="namespaceinnewmarcs__calc.html">innewmarcs_calc</a></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacedimensions.html">dimensions</a></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacereader__modeles.html">reader_modeles</a></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespaceconfig.html">config</a></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespaceinnewmarcs__x.html">innewmarcs_x</a></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacereader__gridsmap.html">reader_gridsmap</a></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">public</span> <a class="code" href="namespaceinnewmarcs__calc.html#a5a692f151a38c6946284b7a2677248f2">innewmarcs_calc_</a></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">private</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">!^^^^^ PUBLIC  ^^^^^</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">!vvvvv PRIVATE vvvvv</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">! Calculated by locatab()</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">! &quot;Dans cette table les modeles entre lesquels on va interpoler ont les numeros:&quot;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__calc.html#aea02c2a57d32c2dc6d841482683710e4">   88</a></span>&#160;  <span class="keywordtype">integer</span> <a class="code" href="namespaceinnewmarcs__calc.html#af8503d5eb95c4934d609ceb73b654f4c">id11</a>, <a class="code" href="namespaceinnewmarcs__calc.html#ad3929aa3a7f7820779fa295f64062972">id12</a>, <a class="code" href="namespaceinnewmarcs__calc.html#ae5449a842f72c63a7fd823de5fcde59c">id21</a>, <a class="code" href="namespaceinnewmarcs__calc.html#aea02c2a57d32c2dc6d841482683710e4">id22</a></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">! Variables calculated by find_two_grid_files()</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__calc.html#aa34fc6065123d3a421a750e075813d58">   91</a></span>&#160;  <span class="keywordtype">character*64</span> :: <a class="code" href="namespaceinnewmarcs__calc.html#aa34fc6065123d3a421a750e075813d58">nomfipl</a>(2)</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__calc.html#a898d1fa273b189d80d0e6e7853729ca6">   92</a></span>&#160;  <span class="keywordtype">real*4</span> <a class="code" href="namespaceinnewmarcs__calc.html#a3a229a13893a718f69100eae556e4429">asalog1</a>, <a class="code" href="namespaceinnewmarcs__calc.html#a898d1fa273b189d80d0e6e7853729ca6">asalog2</a></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">private</span> <a class="code" href="namespaceinnewmarcs__calc.html#a39c9287930f0af835e7bb86a0a46629a">find_two_grid_files</a>, <a class="code" href="namespaceinnewmarcs__calc.html#a618a39507c4e4598b8f56fab3669f337">rangmod</a>, <a class="code" href="namespaceinnewmarcs__calc.html#a24139043019a5cf915efccfb406d4ad8">interpol</a>, <a class="code" href="namespaceinnewmarcs__calc.html#a985d3fc4a4e18ab847b2354c7622b58b">locatab</a>, <a class="code" href="namespaceinnewmarcs__calc.html#add6676d13f5cbe8a3ae3e4b532916265">readerbn</a></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keyword">contains</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">!=======================================================================================</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword">  subroutine </span><a class="code" href="namespaceinnewmarcs__calc.html#ad8e5dc5b56416b3c97ca8166639615ed">innewmarcs_init</a>()</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__calc.html#ad8e5dc5b56416b3c97ca8166639615ed">  105</a></span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a39c9287930f0af835e7bb86a0a46629a">find_two_grid_files</a>()  <span class="comment">! calculates nomfipl, asalog1, asalog2</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keyword">  end</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">!=======================================================================================</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keyword">  subroutine </span><a class="code" href="namespaceinnewmarcs__calc.html#a5a692f151a38c6946284b7a2677248f2">innewmarcs_calc_</a>()</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__calc.html#a5a692f151a38c6946284b7a2677248f2">  114</a></span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: UNIT_MOD = 20, unit_dat = 21  <span class="comment">! file units</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structreader__modeles_1_1modele__record.html">modele_record</a>) :: &amp;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;     aa, bb, cc, dd, &amp;   <span class="comment">! input records</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;     ee, ff, z1, z2, zz  <span class="comment">! records that are calculated by interpol()</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordtype">character*5</span> :: tira = <span class="stringliteral">&#39; Ple &#39;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordtype">character*20</span> tir    <span class="comment">! titre du modele interpole</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">character*65</span> nomfiple</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">real*4</span> bid0, vvt, tostand, t0, t1, tau, to0, tttt</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordtype">integer*4</span> iabon, in, k, n, nna, nnb, nnc, nnd, nntot, nz1, nz2, ntot(2)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">! Variables that must be real*4, as they are going to be written to .mod file</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">real*4</span> asalalf</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">real*4</span>, <span class="keywordtype">dimension(MAX_MODELES_NTOT)</span> :: zle, zlp</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">real*4</span> :: a(<a class="code" href="namespacedimensions.html#a7a4c2d36b9292f6bbb92a44da1493264">max_modeles_ntot</a>*5)  <span class="comment">! modele resultant</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">real*4</span> :: rteff(2,2), rglog(2,2), ralfa(2)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">character(len=:)</span>, <span class="keywordtype">allocatable</span> :: path  <span class="comment">! full path to .mod file</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">!=====</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">! Initialization</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">!=====</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#ad8e5dc5b56416b3c97ca8166639615ed">innewmarcs_init</a>()</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">!=====</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">! Calculation</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">!=====</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keyword">write</span>(lll,*) <span class="stringliteral">&#39;Creating ASCII file &#39;</span>, <a class="code" href="namespaceconfig.html#ae488bf43899caf8c4c8f5d395efeec01">full_path_w</a>(<a class="code" href="namespaceconfig.html#a7ad16332e4ace604b8aef3be0eb9fa0c">config_fn_moddat</a>)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keyword">call </span>log_info(lll)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keyword">open</span>(unit=unit_dat,file=<a class="code" href="namespaceconfig.html#ae488bf43899caf8c4c8f5d395efeec01">full_path_w</a>(<a class="code" href="namespaceconfig.html#a7ad16332e4ace604b8aef3be0eb9fa0c">config_fn_moddat</a>),status=<span class="stringliteral">&#39;unknown&#39;</span>)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">call </span>log_info(<span class="stringliteral">&#39;Opening binary file &#39;</span>//<a class="code" href="namespaceconfig.html#ae488bf43899caf8c4c8f5d395efeec01">full_path_w</a>(<a class="code" href="namespaceconfig.html#a21084af9bc1961a970e7a5e974c4f962">config_fn_modeles</a>)//&amp;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;     <span class="stringliteral">&#39; in status=&#39;</span>//trim(<a class="code" href="namespaceconfig.html#a195b17dad04a86ad8c7fbe5b3e564de7">config_open_status</a>))</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">open</span>(unit=unit_mod,access=<span class="stringliteral">&#39;direct&#39;</span>,status=<a class="code" href="namespaceconfig.html#a195b17dad04a86ad8c7fbe5b3e564de7">config_open_status</a>, &amp;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;     file=<a class="code" href="namespaceconfig.html#ae488bf43899caf8c4c8f5d395efeec01">full_path_w</a>(<a class="code" href="namespaceconfig.html#a21084af9bc1961a970e7a5e974c4f962">config_fn_modeles</a>), recl=1200)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">! **********************Boucle sur l&#39;abondance*******************</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">do</span> iabon = 1,2 <span class="comment">! on interpole dans 2 grilles d&#39;abondance</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      nomfiple = <a class="code" href="namespaceinnewmarcs__calc.html#aa34fc6065123d3a421a750e075813d58">nomfipl</a>(iabon)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      path = <a class="code" href="namespaceconfig.html#ae488bf43899caf8c4c8f5d395efeec01">full_path_w</a>(nomfiple)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">!-------------------------------------------------------------</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="comment">! On cherche ou se trouvent (teff, glog)  par rapport a la table</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a985d3fc4a4e18ab847b2354c7622b58b">locatab</a>(path) <span class="comment">! calculates id11, id12, id21, id22</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keyword">call </span>log_info(<span class="stringliteral">&#39;On va interpoler dans la table de Plez &#39;</span>//nomfiple//&amp;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;       <span class="stringliteral">&#39;; indice d&#39;</span><span class="stringliteral">&#39;abondance: &#39;</span>//int2str(iabon))</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">!-------------------------------------------------------------</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="comment">! Lecture des modeles</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="comment">! Note: last two logical values control whether to open and close the file</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="comment">!       File is opened and kept open; then closed at the last call to readerbn()</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereader__modeles.html#a9d5d25c9605940c3474e28c248293827">open_mod_file</a>(path)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#add6676d13f5cbe8a3ae3e4b532916265">readerbn</a>(<a class="code" href="namespaceinnewmarcs__calc.html#af8503d5eb95c4934d609ceb73b654f4c">id11</a>, aa)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      rteff(1,1) = aa%teff</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      rglog(1,1) = aa%glog</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#add6676d13f5cbe8a3ae3e4b532916265">readerbn</a>(<a class="code" href="namespaceinnewmarcs__calc.html#ad3929aa3a7f7820779fa295f64062972">id12</a>, bb)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      rteff(1,2) = bb%teff</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      rglog(1,2) = bb%glog</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#add6676d13f5cbe8a3ae3e4b532916265">readerbn</a>(<a class="code" href="namespaceinnewmarcs__calc.html#ae5449a842f72c63a7fd823de5fcde59c">id21</a>, cc)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      rteff(2,1) = cc%teff</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      rglog(2,1) = cc%glog</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#add6676d13f5cbe8a3ae3e4b532916265">readerbn</a>(<a class="code" href="namespaceinnewmarcs__calc.html#aea02c2a57d32c2dc6d841482683710e4">id22</a>, dd)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      rteff(2,2) = dd%teff</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      rglog(2,2) = dd%glog</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereader__modeles.html#a530daca27088cc43a087d0ed4815b456">close_mod_file</a>()</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">! sets the alpha abundance of the models for each iabon</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      ralfa(iabon)=dd%asalalf  <span class="comment">! takes asalalf from record d</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="comment">! write(6,*) &#39; &#39;</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="comment">! write(6,*) &#39; Valeur des rglog&#39;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="comment">! write(6,*) &#39; rglog(1,i)&#39;, (rglog(1,i),i=1,2)</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="comment">! write(6,*) &#39; rglog(2,i)&#39;, (rglog(2,i),i=1,2)</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      to0 = amax1(aa%t5l(1), bb%t5l(1), cc%t5l(1), dd%t5l(1))</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      nna = int((to0-aa%t5l(1))*10+0.1)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      nnb = int((to0-bb%t5l(1))*10+0.1)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      nnc = int((to0-cc%t5l(1))*10+0.1)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      nnd = int((to0-dd%t5l(1))*10+0.1)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="comment">! write(lll,*) &#39; to0max=&#39;, to0</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="comment">! call log_debug(lll)</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="comment">! write(lll,*) aa%t5l(1),bb%t5l(1),cc%t5l(1),dd%t5l(1)</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="comment">! call log_debug(lll)</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="comment">! write(lll,*) &#39; couches a oter&#39;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="comment">! call log_debug(lll)</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="comment">! write(lll,*)  nna, nnb, nnc, nnd</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="comment">! call log_debug(lll)</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="comment">! les 4 modeles doivent commencer au meme niveau en log toR</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">if</span>(nna .gt. 0) <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a618a39507c4e4598b8f56fab3669f337">rangmod</a>(aa, aa%ntot, nna)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">if</span>(nnb .gt. 0) <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a618a39507c4e4598b8f56fab3669f337">rangmod</a>(bb, bb%ntot, nnb)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">if</span>(nnc .gt. 0) <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a618a39507c4e4598b8f56fab3669f337">rangmod</a>(cc, cc%ntot, nnc)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">if</span>(nnd .gt. 0) <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a618a39507c4e4598b8f56fab3669f337">rangmod</a>(dd, dd%ntot, nnd)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      ntot(iabon) = min0(aa%ntot, bb%ntot, cc%ntot, dd%ntot)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="comment">!!!! write(lll,*) &#39;   ntot(&#39;,iabon,&#39;)=&#39;, ntot(iabon)</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="comment">!!!! call log_debug(lll)</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="comment">! interpolation sur log g   pour les 2 valeurs de teta</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      t0 = rglog(1,2)-rglog(1,1)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      t1 = <a class="code" href="namespaceinnewmarcs__x.html#a3a715cba698db477f3106b89369278e5">x_glog</a>-rglog(1,1)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="comment">! write(6,*) &#39;  t0,t1 &#39;,t0,t1</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="comment">! write(6,102)  rteff(1,1), x_glog</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="comment">! 102 format(&#39;  modele interpole avec   Teff=&#39;,f9.3,&#39; log g=&#39;, f9.3)</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a24139043019a5cf915efccfb406d4ad8">interpol</a>(t0, t1, aa, bb, ee, ntot(iabon))</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a24139043019a5cf915efccfb406d4ad8">interpol</a>(t0, t1, cc, dd, ff, ntot(iabon))</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="comment">! interpolation sur t</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      t0 = rteff(2,1)-rteff(1,1)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      t1 = <a class="code" href="namespaceinnewmarcs__x.html#a398298b0edbd739992bdd19c63d3ca7c">x_teff</a>-rteff(1,1)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">! write(6,*) &#39;  t0,t1 &#39;,t0,t1</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">! write(6,102) x_teff, x_glog</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">if</span> (iabon .eq. 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a24139043019a5cf915efccfb406d4ad8">interpol</a>(t0, t1, ee, ff, z1, ntot(iabon))</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a24139043019a5cf915efccfb406d4ad8">interpol</a>(t0, t1, ee, ff, z2, ntot(iabon))</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">! On a 2 modeles l&#39;un interpole ds grille a asalog1 et asalog2</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">!     interpolation sur l&#39;abondance</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">!     les 2 modeles doivent commencer au meme niveau en log to</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">!     et avoir la meme longueur</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    to0 = amax1(z1%t5l(1), z2%t5l(1))</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    nz1 = int((to0-z1%t5l(1))*10+0.1)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    nz2 = int((to0-z2%t5l(1))*10+0.1)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">! write(lll,*)&#39; to0max=&#39;, to0</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">! call log_debug(lll)</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">! write(lll,*) z1%t5l(1),z2%t5l(1)</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">! call log_debug(lll)</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">! call log_debug(&#39; couches a oter:&#39;)</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">! write(lll,*) nz1, nz2</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">! call log_debug(lll)</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span>(ntot(1) .gt. 0) <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a618a39507c4e4598b8f56fab3669f337">rangmod</a>(z1, ntot(1), nz1)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span>(ntot(2) .gt. 0) <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a618a39507c4e4598b8f56fab3669f337">rangmod</a>(z2, ntot(2), nz2)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    nntot = min0(ntot(1), ntot(2))</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">! write(lll,*) &#39;   nntot=&#39;,nntot</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">! call log_debug(lll)</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    t0 = <a class="code" href="namespaceinnewmarcs__calc.html#a898d1fa273b189d80d0e6e7853729ca6">asalog2</a>-<a class="code" href="namespaceinnewmarcs__calc.html#a3a229a13893a718f69100eae556e4429">asalog1</a></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    t1 = <a class="code" href="namespaceinnewmarcs__x.html#a6b99e08d1f950896d0942333e7edc066">x_asalog</a>-<a class="code" href="namespaceinnewmarcs__calc.html#a3a229a13893a718f69100eae556e4429">asalog1</a></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">!!!! call log_debug(&#39; interpolation sur l&#39;&#39;abondance avec&#39;)</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">!!!! write(lll,*) &#39; asalog2=&#39;,asalog2,&#39;       asalog1=&#39;,asalog1</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">!!!! call log_debug(lll)</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">!!!! write(lll,*) &#39; t0=&#39;, t0, &#39;       t1=&#39;,t1</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">!!!! call log_debug(lll)</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a24139043019a5cf915efccfb406d4ad8">interpol</a>(t0, t1, z1, z2, zz, nntot)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">! calcule les elements alpha resultants</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    asalalf = ralfa(1) + t1/t0*(ralfa(2)-ralfa(1))</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">! write(lll,*) &#39;model 1 asalog, alpha=&#39;,asalog1,ralfa(1)</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">! call log_debug(lll)</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">! write(lll,*) &#39;model 2 asalog, alpha=&#39;,asalog2,ralfa(2)</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">! call log_debug(lll)</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">! write(lll,*) &#39;result: asalog, alpha=&#39;,x_asalog,asalalf</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">! call log_debug(lll)</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">! ***********************Ecriture du rsultat*********************</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">do</span> n = 1,nntot</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      zle(n) = zz%pe(n)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      zlp(n) = zz%pg(n)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      zz%nh(n) = 10**zz%nh(n)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      zz%pe(n) = 10**zz%pe(n)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      zz%pg(n) = 10**zz%pg(n)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    tir=tira//<a class="code" href="namespaceinnewmarcs__x.html#acfb0dabe633715425c3d7b11ae96faa2">x_tirb</a></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    in = 0</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">do</span> n = 1,nntot</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      in = in+1</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      k = (in-1)*5+1</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      a(k)  =zz%nh(n)   <span class="comment">! NH</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      a(k+1)=zz%teta(n) <span class="comment">! T</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      a(k+2)=zz%pe(n)   <span class="comment">! Pe</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      a(k+3)=zz%pg(n)   <span class="comment">! Pg</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      a(k+4)=zz%t5l(n)  <span class="comment">! log to</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">! Writes binary file</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">write</span>(unit_mod, rec=<a class="code" href="namespaceinnewmarcs__x.html#a1a96ef8a82941f6ae8f54e134b06879f">x_inum</a>) &amp;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;     nntot,          &amp;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;     <a class="code" href="namespaceinnewmarcs__x.html#a398298b0edbd739992bdd19c63d3ca7c">x_teff</a>, &amp;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;     <a class="code" href="namespaceinnewmarcs__x.html#a3a715cba698db477f3106b89369278e5">x_glog</a>, &amp;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;     <a class="code" href="namespaceinnewmarcs__x.html#a6b99e08d1f950896d0942333e7edc066">x_asalog</a>, &amp;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;     asalalf,        &amp;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;     dd%nhe,         &amp;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;     tir,            &amp;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;     dd%tiabs,       &amp;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;     (a(k),k=1,nntot*5)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">write</span>(unit_mod,rec=<a class="code" href="namespaceinnewmarcs__x.html#a1a96ef8a82941f6ae8f54e134b06879f">x_inum</a>+1) 9999  <span class="comment">! 4 bytes, i guess</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">! Writes ASCII file</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    bid0 = 0.0</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    vvt = 2.0e+5 <span class="comment">! on prend vt constant</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    tostand = 5000 <span class="comment">! ?</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">write</span>(unit_dat,<span class="stringliteral">&#39;(a30,i8,f10.0,f8.2,2f5.0)&#39;</span>) &amp;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;     <a class="code" href="namespaceconfig.html#af454183274a606d5fe255371f84c9b42">config_modcode</a>, &amp;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;     nntot,             &amp;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;     tostand,           &amp;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;     <a class="code" href="namespaceinnewmarcs__x.html#a3a715cba698db477f3106b89369278e5">x_glog</a>,    &amp;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;     bid0,              &amp;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;     bid0</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">do</span> n = 1,nntot</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      tau=10**zz%t5l(n)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      tttt=5040/zz%teta(n)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keyword">write</span>(unit_dat,<span class="stringliteral">&#39;(e15.5,f10.0,3e15.6)&#39;</span>) zz%t5l(n), tttt, zle(n), zlp(n), vvt</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keyword">close</span>(unit=unit_mod)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">close</span>(unit=unit_dat)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keyword">  end</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keyword">  subroutine </span><a class="code" href="namespaceinnewmarcs__calc.html#a39c9287930f0af835e7bb86a0a46629a">find_two_grid_files</a>()</div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__calc.html#a39c9287930f0af835e7bb86a0a46629a">  369</a></span>&#160;    <span class="keywordtype">integer</span> i</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordtype">logical</span> :: flag_found = .false.</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">do</span> i = 1, <a class="code" href="namespacereader__gridsmap.html#a26dae8e05a8b25bcaa0993330cce3c32">gridsmap_num_files</a>-1</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceinnewmarcs__x.html#a6b99e08d1f950896d0942333e7edc066">x_asalog</a> .ge. <a class="code" href="namespacereader__gridsmap.html#afe3f5e74f2b37353b9913026014b1e76">gridsmap_asalog</a>(i) .and. &amp;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          <a class="code" href="namespaceinnewmarcs__x.html#a6b99e08d1f950896d0942333e7edc066">x_asalog</a> .lt. <a class="code" href="namespacereader__gridsmap.html#afe3f5e74f2b37353b9913026014b1e76">gridsmap_asalog</a>(i+1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="namespaceinnewmarcs__calc.html#aa34fc6065123d3a421a750e075813d58">nomfipl</a>(1) = <a class="code" href="namespacereader__gridsmap.html#a870bb5c2e5c81772feded9fd1d0035cc">gridsmap_fn</a>(i)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <a class="code" href="namespaceinnewmarcs__calc.html#aa34fc6065123d3a421a750e075813d58">nomfipl</a>(2) = <a class="code" href="namespacereader__gridsmap.html#a870bb5c2e5c81772feded9fd1d0035cc">gridsmap_fn</a>(i+1)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <a class="code" href="namespaceinnewmarcs__calc.html#a3a229a13893a718f69100eae556e4429">asalog1</a> = <a class="code" href="namespacereader__gridsmap.html#afe3f5e74f2b37353b9913026014b1e76">gridsmap_asalog</a>(i) <span class="comment">!sert a l&#39;interpolation sur la metallicite</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="namespaceinnewmarcs__calc.html#a898d1fa273b189d80d0e6e7853729ca6">asalog2</a> = <a class="code" href="namespacereader__gridsmap.html#afe3f5e74f2b37353b9913026014b1e76">gridsmap_asalog</a>(i+1)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        flag_found = .true.</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> (.not. flag_found) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keyword">call </span>pfant_halt(<span class="stringliteral">&#39;Metallicity &#39;</span>//real42str(<a class="code" href="namespaceinnewmarcs__x.html#a6b99e08d1f950896d0942333e7edc066">x_asalog</a>, 3)//<span class="stringliteral">&#39; is out of interval [&#39;</span>//&amp;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;       real42str(<a class="code" href="namespacereader__gridsmap.html#afe3f5e74f2b37353b9913026014b1e76">gridsmap_asalog</a>(1), 3)//<span class="stringliteral">&#39;, &#39;</span>//real42str(<a class="code" href="namespacereader__gridsmap.html#afe3f5e74f2b37353b9913026014b1e76">gridsmap_asalog</a>(<a class="code" href="namespacereader__gridsmap.html#a26dae8e05a8b25bcaa0993330cce3c32">gridsmap_num_files</a>), 3)//<span class="stringliteral">&#39;[&#39;</span>)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keyword">  end</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">!=======================================================================================</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keyword">  subroutine </span><a class="code" href="namespaceinnewmarcs__calc.html#a24139043019a5cf915efccfb406d4ad8">interpol</a>(t0, t1, r1, r2, rr, ntot)</div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__calc.html#a24139043019a5cf915efccfb406d4ad8">  396</a></span>&#160;    <span class="keywordtype">real*4</span>, <span class="keywordtype">intent(in)</span> :: t0, t1</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structreader__modeles_1_1modele__record.html">modele_record</a>), <span class="keywordtype">intent(in)</span> :: r1, r2</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structreader__modeles_1_1modele__record.html">modele_record</a>), <span class="keywordtype">intent(out)</span> :: rr</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">real*4</span> u0, t2</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">integer</span> ntot, n</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    t2=t1/t0</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">do</span> n=1,ntot</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      u0 = r2%nh(n)-r1%nh(n)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      rr%nh(n) = r1%nh(n) + (u0*t2)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      u0 = r2%teta(n)-r1%teta(n)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      rr%teta(n)= r1%teta(n) + (u0*t2)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      u0 = r2%pe(n)-r1%pe(n)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      rr%pe(n)= r1%pe(n) + (u0*t2)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      u0 = r2%pg(n)-r1%pg(n)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      rr%pg(n) = r1%pg(n) + (u0*t2)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      rr%t5l(n) = r1%t5l(n)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="comment">! if(n.le.5) then</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="comment">!   write(6,&#39;(i4,5f14.4)&#39;)n,rr%nh(n),rr%teta(n),rr%pe(n),rr%pg(n),rr%t5l(n)</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="comment">! end if</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keyword">  end</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">!=======================================================================================</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keyword">  subroutine </span><a class="code" href="namespaceinnewmarcs__calc.html#a618a39507c4e4598b8f56fab3669f337">rangmod</a>(rr, ntot, n)</div>
<div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__calc.html#a618a39507c4e4598b8f56fab3669f337">  432</a></span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structreader__modeles_1_1modele__record.html">modele_record</a>), <span class="keywordtype">intent(inout)</span> :: rr</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: ntot</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordtype">integer</span> k</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    ntot = ntot-n</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">do</span> k = 1, ntot</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      rr%nh(k) = rr%nh(k+n)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      rr%teta(k) = rr%teta(k+n)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      rr%pe(k) = rr%pe(k+n)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      rr%pg(k) = rr%pg(k+n)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      rr%t5l(k) = rr%t5l(k+n)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="keyword">  end</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">!=======================================================================================</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keyword">  subroutine </span><a class="code" href="namespaceinnewmarcs__calc.html#a985d3fc4a4e18ab847b2354c7622b58b">locatab</a>(path)</div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__calc.html#a985d3fc4a4e18ab847b2354c7622b58b">  462</a></span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: path</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: MAX_NT=20, &amp;  <span class="comment">! Maximum number of different temperatures</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                          max_ng=20     <span class="comment">! Maximum number of different glog or each temperature</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">integer*4</span> :: idt(max_nt), &amp; <span class="comment">! index of first record for each tempearture</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                 ing(max_ng), &amp; <span class="comment">! number of glog for each temperature</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                 jg1(max_ng), &amp;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                 jg2(max_ng)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">!!!!!!!             idta(MAX_NT), &amp; ! index of first record for each tempearture</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">!!!!!!!             inga(MAX_NT)    ! number of glog for each temperature</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">real*8</span> :: rteff(max_nt), rglog(max_ng)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">!!!!!!! ,r1teff(MAX_NT)</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">!!!!!!! real*8 :: agloga1(MAX_NG),agloga2(MAX_NG),agloga3(MAX_NG),agloga4(MAX_NG), &amp;</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">!!!!!!! agloga5(MAX_NG),agloga6(MAX_NT),agloga7(MAX_NT)</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">real*8</span> :: aglog(max_nt,max_ng)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">integer</span> i, j, jjt, jt1, jt2, n, ng, ngg, nt</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structreader__modeles_1_1modele__record.html">modele_record</a>) :: r  <span class="comment">! filled by read_mod_record()</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordtype">integer</span> inum, num_rec</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordtype">real*8</span> teff_last</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keyword">call </span>log_debug(entering//<span class="stringliteral">&#39;Entree dans le SP locatab&#39;</span>)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">!=====</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">! Mounts data variables from file</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">!=====</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">! First task is to</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">! mount (nt, rteff, idt, ing, aglog) from file</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    teff_last = -1</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    nt = 0</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    num_rec = <a class="code" href="namespacereader__modeles.html#ae0f6e205a59a9af4deb592b1320b3545">get_num_records</a>(path)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keyword">call </span>log_debug(<span class="stringliteral">&#39;Number of records: &#39;</span>//int2str(num_rec))</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacereader__modeles.html#a9d5d25c9605940c3474e28c248293827">open_mod_file</a>(path)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">do</span> inum = 1, num_rec</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacereader__modeles.html#a517a20baf9690e9a3d5cff549d89269e">read_mod_record</a>(inum, r)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="keywordflow">if</span> (inum .eq. 1 .or. abs(teff_last-r%teff) .gt. 0.001) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span> (inum .gt. 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          ing(nt) = ng</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        teff_last = r%teff</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        nt = nt+1</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keyword">call </span>assert_le(nt, max_nt, <span class="stringliteral">&#39;locatab()&#39;</span>, <span class="stringliteral">&#39;nt&#39;</span>, <span class="stringliteral">&#39;MAX_NT&#39;</span>)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        ng = 0</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        rteff(nt) = r%teff</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        idt(nt) = inum</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      ng = ng+1</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      aglog(nt,ng) = r%glog</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    ing(inum) = ng</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacereader__modeles.html#a530daca27088cc43a087d0ed4815b456">close_mod_file</a>()</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keyword">call </span>log_debug(<span class="stringliteral">&#39;teff=&#39;</span>//real42str(<a class="code" href="namespaceinnewmarcs__x.html#a398298b0edbd739992bdd19c63d3ca7c">x_teff</a>, 1))</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keyword">call </span>log_debug(<span class="stringliteral">&#39;glog=&#39;</span>//real42str(<a class="code" href="namespaceinnewmarcs__x.html#a3a715cba698db477f3106b89369278e5">x_glog</a>, 3))</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keyword">call </span>log_debug(<span class="stringliteral">&#39;nt=&#39;</span>//int2str(nt))</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keyword">write</span>(lll,*) <span class="stringliteral">&#39;idt=&#39;</span>, (idt(i), i=1,nt)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keyword">write</span>(lll,*) <span class="stringliteral">&#39;ing=&#39;</span>, (ing(i), i=1,nt)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">do</span> i = 1, nt</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keyword">write</span>(lll,*) <span class="stringliteral">&#39;rteff(&#39;</span>, i, <span class="stringliteral">&#39;)=&#39;</span>, rteff(i)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keyword">write</span>(lll,*) <span class="stringliteral">&#39;aglog(i,:)=&#39;</span>, (aglog(i,j), j=1,ing(i))</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keyword">call </span>log_debug(<span class="stringliteral">&#39;Liste du nbre de g en fonction de t&#39;</span>)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keyword">write</span>(lll,*) (ing(n),n=1,nt)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">! sera suivi d&#39;ordres equivalent si plusieurs abond donc autres IABON</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">! etc...</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">do</span> i=1,nt</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      jt2 = i</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="namespaceinnewmarcs__x.html#a398298b0edbd739992bdd19c63d3ca7c">x_teff</a> .lt. rteff(i)) <span class="keywordflow">go to</span> 11</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    11 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">if</span> (jt2 .eq. 1) jt2 = 2</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    jt1 = jt2-1</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keyword">write</span>(lll,*) <span class="stringliteral">&#39;Indices de temperatures&#39;</span>, jt1,jt2</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">do</span> jjt=jt1,jt2</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      ngg=ing(jjt)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="keyword">write</span>(lll,*)<span class="stringliteral">&#39;jtt=&#39;</span>,jjt,<span class="stringliteral">&#39;   ngg=&#39;</span>,ngg</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keyword">write</span>(lll,*) <span class="stringliteral">&#39;Nbre de gravite pour la temp ngg=&#39;</span>,ngg</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordflow">do</span> i=1,ngg</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        rglog(i)=aglog(jjt,i)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keyword">write</span>(lll,*) <span class="stringliteral">&#39; rglog(i) pour jjt=&#39;</span>, jjt</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keyword">write</span>(lll,<span class="stringliteral">&#39;(10f5.1)&#39;</span>) (rglog(i),i=1,ngg)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">do</span> i = 1,ngg</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        jg2(jjt)=i</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="namespaceinnewmarcs__x.html#a3a715cba698db477f3106b89369278e5">x_glog</a> .lt. rglog(i)) <span class="keywordflow">go to</span> 12</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      12 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordflow">if</span> (jg2(jjt) .eq. 1) jg2(jjt) = 2</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      jg1(jjt)=jg2(jjt)-1</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keyword">write</span>(lll,*) <span class="stringliteral">&#39; jjt jg1 jg2&#39;</span>, jjt, jg1(jjt), jg2(jjt)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keyword">write</span>(lll,*) <span class="stringliteral">&#39; jjt, idt jg1(jjt), jg2(jjt) &#39;</span>,jt1,idt(jt1), jg1(jt1), jg2(jt1)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keyword">write</span>(lll,*) <span class="stringliteral">&#39; jjt, idt jg1(jjt), jg2(jjt) &#39;</span>,jt2,idt(jt2), jg1(jt2) , jg2(jt2)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">! ID des modeles dans la table</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <a class="code" href="namespaceinnewmarcs__calc.html#af8503d5eb95c4934d609ceb73b654f4c">id11</a> = idt(jt1)+jg1(jt1)-1</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <a class="code" href="namespaceinnewmarcs__calc.html#ad3929aa3a7f7820779fa295f64062972">id12</a> = idt(jt1)+jg2(jt1)-1</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <a class="code" href="namespaceinnewmarcs__calc.html#ae5449a842f72c63a7fd823de5fcde59c">id21</a> = idt(jt2)+jg1(jt2)-1</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="namespaceinnewmarcs__calc.html#aea02c2a57d32c2dc6d841482683710e4">id22</a> = idt(jt2)+jg2(jt2)-1</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keyword">call </span>log_debug(<span class="stringliteral">&#39;Dans cette table les modeles entre lesquels on va interpoler ont les numeros:&#39;</span>)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keyword">write</span>(lll,*)  <a class="code" href="namespaceinnewmarcs__calc.html#af8503d5eb95c4934d609ceb73b654f4c">id11</a>,<a class="code" href="namespaceinnewmarcs__calc.html#ad3929aa3a7f7820779fa295f64062972">id12</a>,<a class="code" href="namespaceinnewmarcs__calc.html#ae5449a842f72c63a7fd823de5fcde59c">id21</a>,<a class="code" href="namespaceinnewmarcs__calc.html#aea02c2a57d32c2dc6d841482683710e4">id22</a></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keyword">call </span>log_debug(lll)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keyword">call </span>log_debug(leaving//<span class="stringliteral">&#39;Sortie de locatab&#39;</span>)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="keyword">  end</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">!=======================================================================================</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keyword">  subroutine </span><a class="code" href="namespaceinnewmarcs__calc.html#add6676d13f5cbe8a3ae3e4b532916265">readerbn</a>(rec_id, r)</div>
<div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="namespaceinnewmarcs__calc.html#add6676d13f5cbe8a3ae3e4b532916265">  618</a></span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: rec_id</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structreader__modeles_1_1modele__record.html">modele_record</a>), <span class="keywordtype">intent(out)</span> :: r</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordtype">integer</span> i</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacereader__modeles.html#a517a20baf9690e9a3d5cff549d89269e">read_mod_record</a>(rec_id, r)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keyword">write</span>(lll,<span class="stringliteral">&#39;(f10.0,4f10.2,5a4)&#39;</span>) r%teff, r%glog, r%asalog, r%asalalf, r%nhe, r%tit</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">do</span> i=1,r%ntot</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      r%nh(i) = alog10(r%nh(i))</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      r%pe(i) = alog10(r%pe(i))</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      r%pg(i) = alog10(r%pg(i))</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">!!!! call log_debug(&#39;        log NH           TETA          log PE         log PG     To(5000)&#39;)</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">!!!! do i = 1, 3</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">!!!!   write(lll,&#39;(e16.4,f15.4,2e16.4,f12.4)&#39;) r%nh(i), r%teta(i), r%pe(i), r%pg(i), r%t5l(i)</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">!!!!   call log_debug(lll)</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">!!!! end do</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="comment">!!!! call log_debug(&#39;     ETC.....&#39;)</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="keyword">  end</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keyword">end</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">!|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">!||| PROGRAM |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">!|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div>
<div class="line"><a name="l00650"></a><span class="lineno"><a class="line" href="innewmarcs_8f90.html#a0c25c8798b248ce7840bb628bac71800">  650</a></span>&#160;<span class="keyword">program</span> <a class="code" href="innewmarcs_8f90.html#a0c25c8798b248ce7840bb628bac71800">innewmarcs</a></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespaceconfig.html">config</a></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacelogging.html">logging</a></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacewelcome.html">welcome</a></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespaceinnewmarcs__calc.html">innewmarcs_calc</a></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespaceinnewmarcs__x.html">innewmarcs_x</a></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordtype">use </span><a class="code" href="namespacereader__gridsmap.html">reader_gridsmap</a></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <a class="code" href="namespaceconfig.html#a474139c374d4696cc2513fcf486e4d1c">execonf_name</a> = <span class="stringliteral">&#39;inneWmarcs&#39;</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keyword">call </span><a class="code" href="namespaceconfig.html#a18ef2bb8c5d4d83be0bde27a470ad65e">config_init</a>()</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keyword">call </span><a class="code" href="namespacereader__gridsmap.html#a5e53f676bbb6b2b85b1ca556dfbf0f4a">read_gridsmap</a>()</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__x.html#a3f35348d405aa967eb1a95335a4b4d28">innewmarcs_init_x</a>()</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keyword">call </span><a class="code" href="namespaceinnewmarcs__calc.html#a5a692f151a38c6946284b7a2677248f2">innewmarcs_calc_</a>()</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="keyword">end</span></div>
<div class="ttc" id="innewmarcs_8f90_html_a0c25c8798b248ce7840bb628bac71800"><div class="ttname"><a href="innewmarcs_8f90.html#a0c25c8798b248ce7840bb628bac71800">innewmarcs</a></div><div class="ttdeci">program innewmarcs</div><div class="ttdoc">INNEWMARCS. </div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00650">innewmarcs.f90:650</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_a898d1fa273b189d80d0e6e7853729ca6"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#a898d1fa273b189d80d0e6e7853729ca6">innewmarcs_calc::asalog2</a></div><div class="ttdeci">real *4 asalog2</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00092">innewmarcs.f90:92</a></div></div>
<div class="ttc" id="namespaceconfig_html_a4758985ac722154dea63f96f73b84657"><div class="ttname"><a href="namespaceconfig.html#a4758985ac722154dea63f96f73b84657">config::config_tirb</a></div><div class="ttdeci">character(len_tirb) config_tirb</div><div class="ttdoc">option: tirb </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00497">config.f90:497</a></div></div>
<div class="ttc" id="namespacelogging_html"><div class="ttname"><a href="namespacelogging.html">logging</a></div><div class="ttdoc">Routines to write text to screen and/or log file. </div><div class="ttdef"><b>Definition:</b> <a href="logging_8f90_source.html#l00025">logging.f90:25</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_a618a39507c4e4598b8f56fab3669f337"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#a618a39507c4e4598b8f56fab3669f337">innewmarcs_calc::rangmod</a></div><div class="ttdeci">subroutine, private rangmod(rr, ntot, n)</div><div class="ttdoc">Enlever les n premieres couches a un modele. </div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00432">innewmarcs.f90:432</a></div></div>
<div class="ttc" id="namespacereader__gridsmap_html_a26dae8e05a8b25bcaa0993330cce3c32"><div class="ttname"><a href="namespacereader__gridsmap.html#a26dae8e05a8b25bcaa0993330cce3c32">reader_gridsmap::gridsmap_num_files</a></div><div class="ttdeci">integer gridsmap_num_files</div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l01268">readers.f90:1268</a></div></div>
<div class="ttc" id="namespacereader__gridsmap_html_afe3f5e74f2b37353b9913026014b1e76"><div class="ttname"><a href="namespacereader__gridsmap.html#afe3f5e74f2b37353b9913026014b1e76">reader_gridsmap::gridsmap_asalog</a></div><div class="ttdeci">real *4, dimension(max_gridsmap_num_files) gridsmap_asalog</div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l01269">readers.f90:1269</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__x_html_a6b99e08d1f950896d0942333e7edc066"><div class="ttname"><a href="namespaceinnewmarcs__x.html#a6b99e08d1f950896d0942333e7edc066">innewmarcs_x::x_asalog</a></div><div class="ttdeci">real *4 x_asalog</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00015">innewmarcs.f90:15</a></div></div>
<div class="ttc" id="namespacereader__modeles_html"><div class="ttname"><a href="namespacereader__modeles.html">reader_modeles</a></div><div class="ttdoc">Reading routines and variable declarations for dfile:modeles. </div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l00393">readers.f90:393</a></div></div>
<div class="ttc" id="namespaceconfig_html_a195b17dad04a86ad8c7fbe5b3e564de7"><div class="ttname"><a href="namespaceconfig.html#a195b17dad04a86ad8c7fbe5b3e564de7">config::config_open_status</a></div><div class="ttdeci">character *20 config_open_status</div><div class="ttdoc">option: open_status </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00491">config.f90:491</a></div></div>
<div class="ttc" id="namespacereader__gridsmap_html"><div class="ttname"><a href="namespacereader__gridsmap.html">reader_gridsmap</a></div><div class="ttdoc">Reading routines and variable declarations for dfile:gridsmap (used by innewmarcs) ...</div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l01259">readers.f90:1259</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__x_html_acfb0dabe633715425c3d7b11ae96faa2"><div class="ttname"><a href="namespaceinnewmarcs__x.html#acfb0dabe633715425c3d7b11ae96faa2">innewmarcs_x::x_tirb</a></div><div class="ttdeci">character(len_tirb) x_tirb</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00016">innewmarcs.f90:16</a></div></div>
<div class="ttc" id="namespacereader__modeles_html_ae0f6e205a59a9af4deb592b1320b3545"><div class="ttname"><a href="namespacereader__modeles.html#ae0f6e205a59a9af4deb592b1320b3545">reader_modeles::get_num_records</a></div><div class="ttdeci">integer function get_num_records(path_to_file)</div><div class="ttdoc">Returns number of records in file. </div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l00447">readers.f90:447</a></div></div>
<div class="ttc" id="namespaceconfig_html_a18ef2bb8c5d4d83be0bde27a470ad65e"><div class="ttname"><a href="namespaceconfig.html#a18ef2bb8c5d4d83be0bde27a470ad65e">config::config_init</a></div><div class="ttdeci">subroutine config_init()</div><div class="ttdoc">Initialization of this module. </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00624">config.f90:624</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_ad3929aa3a7f7820779fa295f64062972"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#ad3929aa3a7f7820779fa295f64062972">innewmarcs_calc::id12</a></div><div class="ttdeci">integer id12</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00088">innewmarcs.f90:88</a></div></div>
<div class="ttc" id="namespaceconfig_html"><div class="ttname"><a href="namespaceconfig.html">config</a></div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00436">config.f90:436</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_a5a692f151a38c6946284b7a2677248f2"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#a5a692f151a38c6946284b7a2677248f2">innewmarcs_calc::innewmarcs_calc_</a></div><div class="ttdeci">subroutine, public innewmarcs_calc_()</div><div class="ttdoc">Main routine of this module. </div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00114">innewmarcs.f90:114</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__x_html_a1a96ef8a82941f6ae8f54e134b06879f"><div class="ttname"><a href="namespaceinnewmarcs__x.html#a1a96ef8a82941f6ae8f54e134b06879f">innewmarcs_x::x_inum</a></div><div class="ttdeci">integer x_inum</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00017">innewmarcs.f90:17</a></div></div>
<div class="ttc" id="namespacereader__gridsmap_html_a5e53f676bbb6b2b85b1ca556dfbf0f4a"><div class="ttname"><a href="namespacereader__gridsmap.html#a5e53f676bbb6b2b85b1ca556dfbf0f4a">reader_gridsmap::read_gridsmap</a></div><div class="ttdeci">subroutine read_gridsmap()</div><div class="ttdoc">Reads map of models: dfile:gridsmap. </div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l01285">readers.f90:1285</a></div></div>
<div class="ttc" id="namespacereader__modeles_html_a530daca27088cc43a087d0ed4815b456"><div class="ttname"><a href="namespacereader__modeles.html#a530daca27088cc43a087d0ed4815b456">reader_modeles::close_mod_file</a></div><div class="ttdeci">subroutine close_mod_file()</div><div class="ttdoc">Closes open file. </div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l00478">readers.f90:478</a></div></div>
<div class="ttc" id="namespacereader__main_html_ab0340083926cd8b86e6a42dd62c7ee6b"><div class="ttname"><a href="namespacereader__main.html#ab0340083926cd8b86e6a42dd62c7ee6b">reader_main::assure_read_main</a></div><div class="ttdeci">subroutine assure_read_main()</div><div class="ttdoc">Makes sure that read_main() has been called. </div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l00248">readers.f90:248</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__x_html_a3f35348d405aa967eb1a95335a4b4d28"><div class="ttname"><a href="namespaceinnewmarcs__x.html#a3f35348d405aa967eb1a95335a4b4d28">innewmarcs_x::innewmarcs_init_x</a></div><div class="ttdeci">subroutine innewmarcs_init_x()</div><div class="ttdoc">Initializes x_* variables. </div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00024">innewmarcs.f90:24</a></div></div>
<div class="ttc" id="namespaceconfig_html_ad0b23351067d0e18d2f215b8e6d87eb7"><div class="ttname"><a href="namespaceconfig.html#ad0b23351067d0e18d2f215b8e6d87eb7">config::config_inum</a></div><div class="ttdeci">integer config_inum</div><div class="ttdoc">option: inum </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00505">config.f90:505</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_ad8e5dc5b56416b3c97ca8166639615ed"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#ad8e5dc5b56416b3c97ca8166639615ed">innewmarcs_calc::innewmarcs_init</a></div><div class="ttdeci">subroutine innewmarcs_init()</div><div class="ttdoc">Initialization of this module. </div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00105">innewmarcs.f90:105</a></div></div>
<div class="ttc" id="namespacedimensions_html_a7a4c2d36b9292f6bbb92a44da1493264"><div class="ttname"><a href="namespacedimensions.html#a7a4c2d36b9292f6bbb92a44da1493264">dimensions::max_modeles_ntot</a></div><div class="ttdeci">integer, parameter max_modeles_ntot</div><div class="ttdoc">Maximum possible value of modeles_ntot. </div><div class="ttdef"><b>Definition:</b> <a href="dimensions_8f90_source.html#l00066">dimensions.f90:66</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_aa34fc6065123d3a421a750e075813d58"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#aa34fc6065123d3a421a750e075813d58">innewmarcs_calc::nomfipl</a></div><div class="ttdeci">character *64, dimension(2) nomfipl</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00091">innewmarcs.f90:91</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_af8503d5eb95c4934d609ceb73b654f4c"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#af8503d5eb95c4934d609ceb73b654f4c">innewmarcs_calc::id11</a></div><div class="ttdeci">integer id11</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00088">innewmarcs.f90:88</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_aea02c2a57d32c2dc6d841482683710e4"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#aea02c2a57d32c2dc6d841482683710e4">innewmarcs_calc::id22</a></div><div class="ttdeci">integer id22</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00088">innewmarcs.f90:88</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_a24139043019a5cf915efccfb406d4ad8"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#a24139043019a5cf915efccfb406d4ad8">innewmarcs_calc::interpol</a></div><div class="ttdeci">subroutine, private interpol(t0, t1, r1, r2, rr, ntot)</div><div class="ttdoc">Interpolation ?doc? </div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00396">innewmarcs.f90:396</a></div></div>
<div class="ttc" id="namespacereader__main_html_a486ec8f0965940c32c610faed704a592"><div class="ttname"><a href="namespacereader__main.html#a486ec8f0965940c32c610faed704a592">reader_main::main_titrav</a></div><div class="ttdeci">character *15 main_titrav</div><div class="ttdoc">Title, e.g. "Sun". </div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l00229">readers.f90:229</a></div></div>
<div class="ttc" id="namespacereader__modeles_html_a9d5d25c9605940c3474e28c248293827"><div class="ttname"><a href="namespacereader__modeles.html#a9d5d25c9605940c3474e28c248293827">reader_modeles::open_mod_file</a></div><div class="ttdeci">subroutine open_mod_file(path_to_file)</div><div class="ttdoc">Opens existing models binary file. </div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l00463">readers.f90:463</a></div></div>
<div class="ttc" id="namespaceconfig_html_a474139c374d4696cc2513fcf486e4d1c"><div class="ttname"><a href="namespaceconfig.html#a474139c374d4696cc2513fcf486e4d1c">config::execonf_name</a></div><div class="ttdeci">character *16 execonf_name</div><div class="ttdoc">Name of executable. Case doesn&#39;t matter. It will be converted to all uppercase or lowercave...</div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00455">config.f90:455</a></div></div>
<div class="ttc" id="namespaceconfig_html_af454183274a606d5fe255371f84c9b42"><div class="ttname"><a href="namespaceconfig.html#af454183274a606d5fe255371f84c9b42">config::config_modcode</a></div><div class="ttdeci">character *25 config_modcode</div><div class="ttdoc">option: modcode </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00495">config.f90:495</a></div></div>
<div class="ttc" id="namespacelogging_html_a4fc75cb7a1e0429e297ce0160f8e2364"><div class="ttname"><a href="namespacelogging.html#a4fc75cb7a1e0429e297ce0160f8e2364">logging::pfant_halt</a></div><div class="ttdeci">subroutine pfant_halt(s, is_bug, is_assertion)</div><div class="ttdoc">Logs message at HALT level and halts program execution with error code -1. </div><div class="ttdef"><b>Definition:</b> <a href="logging_8f90_source.html#l00083">logging.f90:83</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__x_html_a3a715cba698db477f3106b89369278e5"><div class="ttname"><a href="namespaceinnewmarcs__x.html#a3a715cba698db477f3106b89369278e5">innewmarcs_x::x_glog</a></div><div class="ttdeci">real *4 x_glog</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00015">innewmarcs.f90:15</a></div></div>
<div class="ttc" id="namespaceconfig_html_ae488bf43899caf8c4c8f5d395efeec01"><div class="ttname"><a href="namespaceconfig.html#ae488bf43899caf8c4c8f5d395efeec01">config::full_path_w</a></div><div class="ttdeci">character(len=:) function, allocatable full_path_w(filename)</div><div class="ttdoc">Concatenates config_wdir with specific filename. </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l01068">config.f90:1068</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_a3a229a13893a718f69100eae556e4429"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#a3a229a13893a718f69100eae556e4429">innewmarcs_calc::asalog1</a></div><div class="ttdeci">real *4 asalog1</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00092">innewmarcs.f90:92</a></div></div>
<div class="ttc" id="namespaceconfig_html_a858736a1e48025c7a5f70103abc8bdcf"><div class="ttname"><a href="namespaceconfig.html#a858736a1e48025c7a5f70103abc8bdcf">config::config_glog</a></div><div class="ttdeci">real *8 config_glog</div><div class="ttdoc">option: glog </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00501">config.f90:501</a></div></div>
<div class="ttc" id="namespacereader__modeles_html_a517a20baf9690e9a3d5cff549d89269e"><div class="ttname"><a href="namespacereader__modeles.html#a517a20baf9690e9a3d5cff549d89269e">reader_modeles::read_mod_record</a></div><div class="ttdeci">subroutine read_mod_record(rec_id, record)</div><div class="ttdoc">Reads single record from .mod file. </div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l00500">readers.f90:500</a></div></div>
<div class="ttc" id="namespaceconfig_html_a769185a6790e659a782cb1a5ae1c5f34"><div class="ttname"><a href="namespaceconfig.html#a769185a6790e659a782cb1a5ae1c5f34">config::parse_aux_log_assignment</a></div><div class="ttdeci">subroutine parse_aux_log_assignment(varname, value)</div><div class="ttdoc">logging routine: prints variable and assigned value </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l01078">config.f90:1078</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_a39c9287930f0af835e7bb86a0a46629a"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#a39c9287930f0af835e7bb86a0a46629a">innewmarcs_calc::find_two_grid_files</a></div><div class="ttdeci">subroutine, private find_two_grid_files()</div><div class="ttdoc">Fill variables nomfipl, asalog1, asalog2 based on x_asalog. </div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00369">innewmarcs.f90:369</a></div></div>
<div class="ttc" id="structreader__modeles_1_1modele__record_html"><div class="ttname"><a href="structreader__modeles_1_1modele__record.html">reader_modeles::modele_record</a></div><div class="ttdoc">Structure to store atmospheric model read from binary file. Binary file follows "NewMarcs" structure ...</div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l00406">readers.f90:406</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_a985d3fc4a4e18ab847b2354c7622b58b"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#a985d3fc4a4e18ab847b2354c7622b58b">innewmarcs_calc::locatab</a></div><div class="ttdeci">subroutine, private locatab(path)</div><div class="ttdoc">On cherche les numeros des 4 modeles de la table entre lesquels le programme devra interpoler...</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00462">innewmarcs.f90:462</a></div></div>
<div class="ttc" id="namespaceconfig_html_affc9a22fb2947d54c06100575bba55fb"><div class="ttname"><a href="namespaceconfig.html#affc9a22fb2947d54c06100575bba55fb">config::config_teff</a></div><div class="ttdeci">real *8 config_teff</div><div class="ttdoc">option: teff </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00499">config.f90:499</a></div></div>
<div class="ttc" id="namespaceconfig_html_a21084af9bc1961a970e7a5e974c4f962"><div class="ttname"><a href="namespaceconfig.html#a21084af9bc1961a970e7a5e974c4f962">config::config_fn_modeles</a></div><div class="ttdeci">character *64 config_fn_modeles</div><div class="ttdoc">option: fn_modeles </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00477">config.f90:477</a></div></div>
<div class="ttc" id="namespacedimensions_html"><div class="ttname"><a href="namespacedimensions.html">dimensions</a></div><div class="ttdoc">This module contains the declarations for most of the "MAX_" parameters. </div><div class="ttdef"><b>Definition:</b> <a href="dimensions_8f90_source.html#l00021">dimensions.f90:21</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_ae5449a842f72c63a7fd823de5fcde59c"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#ae5449a842f72c63a7fd823de5fcde59c">innewmarcs_calc::id21</a></div><div class="ttdeci">integer id21</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00088">innewmarcs.f90:88</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__x_html_a398298b0edbd739992bdd19c63d3ca7c"><div class="ttname"><a href="namespaceinnewmarcs__x.html#a398298b0edbd739992bdd19c63d3ca7c">innewmarcs_x::x_teff</a></div><div class="ttdeci">real *4 x_teff</div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00015">innewmarcs.f90:15</a></div></div>
<div class="ttc" id="namespaceconfig_html_a7ad16332e4ace604b8aef3be0eb9fa0c"><div class="ttname"><a href="namespaceconfig.html#a7ad16332e4ace604b8aef3be0eb9fa0c">config::config_fn_moddat</a></div><div class="ttdeci">character *64 config_fn_moddat</div><div class="ttdoc">option: --fn_moddat </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00492">config.f90:492</a></div></div>
<div class="ttc" id="namespacereader__main_html_ab83921c26c1f1b4f3d12b8ff7c7158eb"><div class="ttname"><a href="namespacereader__main.html#ab83921c26c1f1b4f3d12b8ff7c7158eb">reader_main::main_glog</a></div><div class="ttdeci">real *8 main_glog</div><div class="ttdoc">log10 of gravity </div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l00205">readers.f90:205</a></div></div>
<div class="ttc" id="namespacewelcome_html"><div class="ttname"><a href="namespacewelcome.html">welcome</a></div><div class="ttdef"><b>Definition:</b> <a href="misc_8f90_source.html#l00548">misc.f90:548</a></div></div>
<div class="ttc" id="namespacereader__gridsmap_html_a870bb5c2e5c81772feded9fd1d0035cc"><div class="ttname"><a href="namespacereader__gridsmap.html#a870bb5c2e5c81772feded9fd1d0035cc">reader_gridsmap::gridsmap_fn</a></div><div class="ttdeci">character *64, dimension(max_gridsmap_num_files) gridsmap_fn</div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l01270">readers.f90:1270</a></div></div>
<div class="ttc" id="namespaceconfig_html_a807f33f9ef82010f14c655e653f0865c"><div class="ttname"><a href="namespaceconfig.html#a807f33f9ef82010f14c655e653f0865c">config::config_asalog</a></div><div class="ttdeci">real *8 config_asalog</div><div class="ttdoc">option: asalog. </div><div class="ttdef"><b>Definition:</b> <a href="config_8f90_source.html#l00503">config.f90:503</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__x_html"><div class="ttname"><a href="namespaceinnewmarcs__x.html">innewmarcs_x</a></div><div class="ttdoc">Declaration and initialization of x_* variables. </div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00008">innewmarcs.f90:8</a></div></div>
<div class="ttc" id="namespacereader__main_html_a743c64b380aba20c8d36ba00b608e68e"><div class="ttname"><a href="namespacereader__main.html#a743c64b380aba20c8d36ba00b608e68e">reader_main::main_asalog</a></div><div class="ttdeci">real *8 main_asalog</div><div class="ttdoc">log10 of metallicity </div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l00205">readers.f90:205</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html_add6676d13f5cbe8a3ae3e4b532916265"><div class="ttname"><a href="namespaceinnewmarcs__calc.html#add6676d13f5cbe8a3ae3e4b532916265">innewmarcs_calc::readerbn</a></div><div class="ttdeci">subroutine, private readerbn(rec_id, r)</div><div class="ttdoc">Lit sur disque acces direct nh,teta,pe,pg,t5l,ntot. </div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00618">innewmarcs.f90:618</a></div></div>
<div class="ttc" id="namespaceinnewmarcs__calc_html"><div class="ttname"><a href="namespaceinnewmarcs__calc.html">innewmarcs_calc</a></div><div class="ttdef"><b>Definition:</b> <a href="innewmarcs_8f90_source.html#l00071">innewmarcs.f90:71</a></div></div>
<div class="ttc" id="namespacereader__main_html"><div class="ttname"><a href="namespacereader__main.html">reader_main</a></div><div class="ttdoc">Reading routines and variable declarations for dfile:main. </div><div class="ttdef"><b>Definition:</b> <a href="readers_8f90_source.html#l00193">readers.f90:193</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="innewmarcs_8f90.html">innewmarcs.f90</a></li>
    <li class="footer">Generated on Thu Aug 27 2015 00:04:11 for PFANT by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
